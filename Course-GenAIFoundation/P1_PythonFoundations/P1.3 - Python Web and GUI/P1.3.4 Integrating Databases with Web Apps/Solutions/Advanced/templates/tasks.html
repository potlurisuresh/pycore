<!DOCTYPE html>
<html>
<head>
    <title>Task Tracker (Advanced)</title>
</head>
<body>
    <h2>Add Task</h2>
    <form method="post" action="/add">
      Description: <input name="description" required> <br>
      Due Date: <input name="due_date" type="date" required> <br>
      <input type="submit" value="Add">
    </form>
    <form method="get" action="/">
      Keyword: <input name="keyword"> 
      Due From: <input name="due_from" type="date"> 
      Due To: <input name="due_to" type="date"> 
      <select name="filter">
        <option value="all">All</option>
        <option value="completed">Completed</option>
        <option value="incomplete">Incomplete</option>
      </select>
      <input type="submit" value="Filter">
    </form>
    <form method="post" action="/batch_complete">
    <h2>All Tasks</h2>
    <ul>
    {% for t in tasks %}
      <li><input type="checkbox" name="ids" value="{{t[0]}}"> {{t[1]}} (Due: {{t[2]}}) - {% if t[3] %}Completed{% else %}Incomplete{% endif %}
        {% if not t[3] %}<a href="/complete/{{t[0]}}">Mark Completed</a>{% endif %}
        {% if t[4] %}<b style="color:red">[Overdue]</b>{% endif %}
      </li>
    {% endfor %}
    </ul>
    <input type="submit" value="Mark Selected Completed">
    </form>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
</body>
</html>
